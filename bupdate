#!/usr/bin/env bash

config="installdirs" # PATH TO INSTALL FILES LIST.
meleename="WillsetMelee"
stdname="WillsetS"

[ "$(id -u)" != "0" ] && echo "Please run as superuser or files cannot be copied!" && exit 1

# Get install dirs from config file.
installs=""
while read -r line; do
  installs="$installs$line "
done < <(grep -vE '^#|$#' $config)
echo $installs

for install in $installs
do
  [ ! -d $install ] && echo "Freeciv data directory not present at $install. Is freeciv installed?" && exit 1
done

# Validation

# $1: directory
# $2: serv file
# $3: name
function validate {  
  if [[ (! -d "$1") || (! -f "$2") ]]
  then
    echo "$3 not present/complete; ensure grab script has been run first."
    exit 1
  fi
}

meleedir="$meleename/$meleename"
meleeserv="$meleename/$meleename.serv"
validate $meleedir $meleeserv $meleename

stddir="$stdname/WillsetS"
stdserv="$stdname/WillsetS.serv"
validate $stddir $stdserv $stdname

# Copy
for install in $installs
do
  echo "Placing installs in $install"
  cp -r "$meleedir" "$install"
  cp -r "$meleeserv" "$install"
  cp -r "$stddir" "$install"
  cp -r "$stdserv" "$install"
done

